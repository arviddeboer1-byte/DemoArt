<!doctype html> <html lang="nl"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width,initial-scale=1" /> <title>Prikbord — Plaats vraag of aanbod (met Firebase)</title> <style> :root{--bg:#f6f8fa;--card:#ffffff;--accent:#3b82f6;--muted:#6b7280;--danger:#ef4444} *{box-sizing:border-box} body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,#f8fafc 0%,var(--bg) 100%); color:#0f172a} header{background:linear-gradient(90deg,#fff 0%, #f1f5f9 100%); padding:18px 20px; display:flex; align-items:center; gap:16px; border-bottom:1px solid #e6eef8} .logo{font-weight:700; font-size:18px; color:var(--accent)} .container{max-width:980px; margin:28px auto; padding:0 16px} /* card */ .card{background:var(--card); border-radius:12px; box-shadow:0 6px 18px rgba(11,22,44,0.06); padding:16px} /* login */ .login{display:flex; gap:12px; align-items:center} .login input[type=email]{padding:10px 12px; border-radius:8px; border:1px solid #e6eef8; min-width:260px} .btn{background:var(--accent); color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer} .btn.ghost{background:transparent; color:var(--accent); border:1px solid #dbeafe} /* grid */ .layout{display:grid; grid-template-columns:320px 1fr; gap:18px; margin-top:18px} @media (max-width:840px){.layout{grid-template-columns:1fr}.left{order:2}} .left .card{position:sticky; top:16px} label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px} input[type=text], textarea, select{width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6eef8} textarea{min-height:100px; resize:vertical} .note-list{display:grid; gap:12px} .note{padding:12px; border-radius:10px; border:1px solid #eef2ff; background:linear-gradient(180deg,#fff,#fbfdff)} .note h4{margin:0 0 6px 0} .meta{font-size:12px; color:var(--muted); margin-bottom:8px} .actions{display:flex; gap:8px} .small{font-size:13px; padding:6px 8px} .pill{display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; background:#eef2ff; color:var(--accent)} .empty{padding:28px; text-align:center; color:var(--muted)} footer{margin-top:28px; text-align:center; color:var(--muted); font-size:13px} .thumb{max-width:120px; max-height:80px; object-fit:cover; border-radius:8px; margin-top:8px} </style> </head> <body> <header> <div class="logo">Prikbord (Firebase)</div> <div style="flex:1"></div> <div class="login card" id="loginCard"> <input type="email" id="loginEmail" placeholder="Vul je e-mail in (geen wachtwoord)" aria-label="e-mail adres" /> <button class="btn" id="sendLinkBtn">Stuur inloglink</button> </div> <div class="card" id="userCard" style="display:none;align-items:center;gap:12px"> <div id="currentUser" style="font-size:14px;color:#0f172a"></div> <button class="btn ghost" id="logoutBtn">Uitloggen</button> </div> </header> <main class="container"> <div class="layout"> <aside class="left"> <div class="card"> <h3>Nieuw briefje plaatsen</h3> <form id="noteForm"> <div style="margin-top:10px"> <label for="type">Keuze</label> <select id="type" required> <option value="vraag">Vraag</option> <option value="aanbod">Aanbod</option> </select> </div> <div style="margin-top:10px"> <label for="name">Naam</label> <input id="name" type="text" placeholder="Je naam" required /> </div> <div style="margin-top:10px"> <label for="contact">Contactgegevens</label> <input id="contact" type="text" placeholder="telefoon, e-mail, website..." required /> </div> <div style="margin-top:10px"> <label for="description">Beschrijving</label> <textarea id="description" placeholder="Wat vraag of bied je aan?" required></textarea> </div> <div style="margin-top:10px"> <label for="photo">Foto (optioneel)</label> <input id="photo" type="file" accept="image/*" /> </div> <div style="display:flex;gap:8px;margin-top:12px"> <button type="submit" class="btn">Plaatsen</button> <button type="button" id="clearBtn" class="btn ghost">Reset</button> </div> <div style="margin-top:8px;font-size:13px;color:var(--muted)">Je moet ingelogd zijn met je e-mailadres om een briefje te plaatsen. We bewaren de briefjes in Firestore; afbeeldingen in Firebase Storage.</div> </form> </div> </aside> <section> <div class="card"> <h3>Prikbord</h3> <div style="margin-top:8px;display:flex;gap:8px;align-items:center"> <input id="search" type="text" placeholder="Zoek op naam, contact of beschrijving..." style="flex:1;padding:8px 10px;border-radius:8px;border:1px solid #e6eef8" /> <select id="filterType" style="padding:8px;border-radius:8px;border:1px solid #e6eef8"> <option value="all">Allemaal</option> <option value="vraag">Vraag</option> <option value="aanbod">Aanbod</option> </select> <button id="refreshBtn" class="btn ghost small">Ververs</button> </div> <div id="notes" style="margin-top:12px" class="note-list"></div> </div> <footer>Made with ❤️ — Firebase (client-only). Vergeet niet je Firebase-config in te vullen en juiste security rules te zetten.</footer> </section> </div> </main> <!-- Firebase v9+ (modular) --> <script type="module"> // ----- VOEG JOUW FIREBASE CONFIG HIER IN ----- // Ga naar https://console.firebase.google.com/, maak een project, zet Authentication -> Email link (passwordless) aan // en maak Firestore in Native mode. Ook Storage kan worden ingeschakeld voor foto's. const firebaseConfig = { apiKey: "AIzaSyDjRzYTrvVHK583A9h3e75LBfmQSWsmz1Y", authDomain: "myremoteagent-bb42c.firebaseapp.com", projectId: "myremoteagent-bb42c", storageBucket: "myremoteagent-bb42c.firebasestorage.app", messagingSenderId: "611952695596", appId: "1:611952695596:web:58e84e24bb70a475e4b489", measurementId: "G-ZY1E7CGRLV" } import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js' import { getAuth, signInWithEmailLink, isSignInWithEmailLink, sendSignInLinkToEmail, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js' import { getFirestore, collection, addDoc, serverTimestamp, onSnapshot, query, orderBy, doc, deleteDoc } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js' import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js' const app = initializeApp(firebaseConfig) const auth = getAuth(app) const db = getFirestore(app) const storage = getStorage(app) // UI refs const loginCard = document.getElementById('loginCard') const userCard = document.getElementById('userCard') const loginEmail = document.getElementById('loginEmail') const sendLinkBtn = document.getElementById('sendLinkBtn') const logoutBtn = document.getElementById('logoutBtn') const currentUser = document.getElementById('currentUser') const noteForm = document.getElementById('noteForm') const notesEl = document.getElementById('notes') const search = document.getElementById('search') const filterType = document.getElementById('filterType') const refreshBtn = document.getElementById('refreshBtn') const clearBtn = document.getElementById('clearBtn') // Local fallback storage key if Firestore not configured const LOCAL_KEY = 'prikbord_local_notes' // Handle sign-in via email link (passwordless) const actionCodeSettings = { // URL you want to redirect back to. Change to your deployed URL. url: window.location.href.split('#')[0], handleCodeInApp: true } sendLinkBtn.addEventListener('click', async ()=>{ const email = loginEmail.value.trim().toLowerCase() if(!/^\S+@\S+\.\S+$/.test(email)){ alert('Voer een geldig e-mail adres in. Bijvoorbeeld: naam@example.com') return } try{ await sendSignInLinkToEmail(auth, email, actionCodeSettings) window.localStorage.setItem('emailForSignIn', email) alert('Inloglink gestuurd — controleer je e-mail en open de link om in te loggen.') loginEmail.value = '' }catch(err){ console.error(err) alert('Fout bij het sturen van link: ' + err.message) } }) // Check if we're returning from an email link if(isSignInWithEmailLink(auth, window.location.href)){ let email = window.localStorage.getItem('emailForSignIn') || '' if(!email){ email = prompt('Voer je e-mail opnieuw in om de aanmelding te voltooien:') || '' } if(email){ signInWithEmailLink(auth, email, window.location.href).then(result=>{ window.localStorage.removeItem('emailForSignIn') // Remove link part from URL history.replaceState(null, '', window.location.pathname) }).catch(err=>{ console.error(err) alert('Kon niet inloggen: ' + err.message) }) } } onAuthStateChanged(auth, user=>{ if(user){ loginCard.style.display = 'none' userCard.style.display = 'flex' currentUser.textContent = user.email startRealtimeListener() }else{ loginCard.style.display = 'flex' userCard.style.display = 'none' currentUser.textContent = '' stopRealtimeListener() // Load local notes as fallback if wanted renderLocalNotes() } }) logoutBtn.addEventListener('click', ()=>{ if(confirm('Weet je zeker dat je wilt uitloggen?')){ signOut(auth).catch(e=>console.error(e)) } }) // Submit note: upload optional photo, then save in Firestore (or local fallback) noteForm.addEventListener('submit', async (e)=>{ e.preventDefault() const user = auth.currentUser const ownerEmail = user ? user.email : null if(!ownerEmail){ alert('Je moet eerst inloggen met je e-mailadres.'); return } const note = { type: document.getElementById('type').value, name: document.getElementById('name').value.trim(), contact: document.getElementById('contact').value.trim(), description: document.getElementById('description').value.trim(), owner: ownerEmail, created: serverTimestamp() } if(!note.name || !note.contact || !note.description){ alert('Vul alle velden in.'); return } const fileInput = document.getElementById('photo') const file = fileInput.files && fileInput.files[0] try{ if(file && storage){ const fileRef = storageRef(storage, prikbord/${Date.now()}_${file.name}) const snap = await uploadBytes(fileRef, file) const url = await getDownloadURL(fileRef) note.photo = url } // Save to firestore await addDoc(collection(db, 'notes'), note) noteForm.reset() alert('Briefje geplaatst') }catch(err){ console.error(err) // fallback: save locally saveLocalNote({id:'l_'+Date.now(), ...note, created: new Date().toISOString()}) alert('Kon niet naar Firestore schrijven — briefje lokaal opgeslagen als fallback.') } }) // Local fallback storage functions function saveLocalNote(n){ const arr = JSON.parse(localStorage.getItem(LOCAL_KEY) || '[]') arr.unshift(n) localStorage.setItem(LOCAL_KEY, JSON.stringify(arr)) renderLocalNotes() } function renderLocalNotes(){ const arr = JSON.parse(localStorage.getItem(LOCAL_KEY) || '[]') notesEl.innerHTML = '' if(arr.length===0) { notesEl.innerHTML = '<div class="empty">Geen briefjes gevonden.</div>'; return } arr.forEach(n=>{ const div = createNoteElement({id:n.id, ...n, created:n.created}) notesEl.appendChild(div) }) } // Real-time listener to Firestore notes collection let unsubscribe = null function startRealtimeListener(){ if(unsubscribe) return const q = query(collection(db, 'notes'), orderBy('created', 'desc')) unsubscribe = onSnapshot(q, snap=>{ const items = [] snap.forEach(docSnap=>{ const data = docSnap.data() items.push({id: docSnap.id, ...data}) }) renderFirestoreNotes(items) }, err=>{ console.error('Listener error', err) }) } function stopRealtimeListener(){ if(unsubscribe){ unsubscribe(); unsubscribe = null } } function renderFirestoreNotes(items){ const q = search.value.trim().toLowerCase() const ft = filterType.value const filtered = items.filter(n=>{ if(ft !== 'all' && n.type !== ft) return false if(!q) return true const hay = (n.name + ' ' + (n.contact||'') + ' ' + (n.description||'')).toLowerCase() return hay.includes(q) }) notesEl.innerHTML = '' if(filtered.length === 0){ notesEl.innerHTML = '<div class="empty">Geen briefjes gevonden.</div>'; return } filtered.forEach(n=>notesEl.appendChild(createNoteElement(n))) } function createNoteElement(n){ const div = document.createElement('div') div.className = 'note' const createdText = n.created && n.created.toDate ? n.created.toDate().toLocaleString() : (n.created ? new Date(n.created).toLocaleString() : '') div.innerHTML = <div style="display:flex;justify-content:space-between;align-items:center"> <h4>${escapeHtml(n.name)}</h4> <div class="pill">${n.type}</div> </div> <div class="meta">Gepost door: ${escapeHtml(n.owner||'')} — ${escapeHtml(createdText)}</div> <div style="white-space:pre-wrap;margin-bottom:8px">${escapeHtml(n.description||'')}</div> <div style="font-size:13px;color:var(--muted);margin-bottom:8px">Contact: ${escapeHtml(n.contact||'')}</div> <div class="actions"> <button class="small btn ghost" data-id="${n.id}" data-action="share">Delen</button> <button class="small btn" data-id="${n.id}" data-action="contact">Contact</button> ${'${'}auth.currentUser && auth.currentUser.email === n.owner ? <button class="small btn ghost" data-id="${n.id}" data-action="delete">Verwijder</button> : ''}${'}'} </div> if(n.photo){ const img = document.createElement('img') img.src = n.photo img.className = 'thumb' div.appendChild(img) } return div } // Buttons inside notes notesEl.addEventListener('click', async (e)=>{ const btn = e.target.closest('button') if(!btn) return const id = btn.dataset.id const action = btn.dataset.action if(action === 'delete'){ if(confirm('Verwijder dit briefje?')){ try{ await deleteDoc(doc(db, 'notes', id)) }catch(err){ console.error(err) alert('Kon niet verwijderen: ' + err.message) } } }else{ // find note in current DOM dataset: we rely on Firestore listener populating // For share, create link with #note=id const noteUrl = window.location.origin + window.location.pathname + '#note=' + encodeURIComponent(id) if(action === 'share'){ const noteEl = btn.closest('.note') const title = noteEl ? noteEl.querySelector('h4').textContent : 'Prikbord' if(navigator.share){ navigator.share({title, text:'Bekijk briefje', url: noteUrl}) }else{ await navigator.clipboard.writeText(noteUrl) alert('Link naar briefje gekopieerd naar klembord') } }else if(action === 'contact'){ // try to detect email // Fetch owner data from Firestore? Simplify: attempt to read contact text from DOM const noteEl = btn.closest('.note') const contactText = noteEl ? noteEl.querySelector('div[style*="Contact:"]').textContent.replace(/^Contact:\s*/,'') : '' const m = contactText.match(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i) if(m){ window.location.href = 'mailto:'+m[0]; return } alert('Geen e-mailadres gevonden in de contactgegevens. Kopieer handmatig:\n' + contactText) } } }) // helpers function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;') } // search/filter handlers search.addEventListener('input', ()=>{ if(unsubscribe) startRealtimeListener(); else renderLocalNotes() }) filterType.addEventListener('change', ()=>{ if(unsubscribe) startRealtimeListener(); else renderLocalNotes() }) refreshBtn.addEventListener('click', ()=>{ if(unsubscribe) startRealtimeListener(); else renderLocalNotes() }) clearBtn.addEventListener('click', ()=>noteForm.reset()) // If URL has #note=... scroll to it after rendering function openNoteFromHash(){ const hash = location.hash if(!hash.startsWith('#note=')) return const id = decodeURIComponent(hash.split('=')[1]) setTimeout(()=>{ const el = document.querySelector([data-id="${CSS.escape(id)}"]) if(el) el.scrollIntoView({behavior:'smooth', block:'center'}) },800) } // init: if logged out, show local notes; if logged in, listener will populate renderLocalNotes() openNoteFromHash() </script> <noscript>Deze pagina heeft JavaScript nodig om correct te werken.</noscript> </body> </html>
